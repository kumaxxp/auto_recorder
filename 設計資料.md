# ðŸ“¦ **è¨­è¨ˆè³‡æ–™ï¼šPCç”¨ Segmentation UI + ä½Žé€Ÿèµ°è¡ŒæŽ¢ç´¢ã‚·ã‚¹ãƒ†ãƒ **

### â€» Phase1 å®Ÿè£…å¯¾è±¡ï¼ˆèµ°è¡Œåˆ¶å¾¡ã¯æŽ¥ç¶šã ã‘ã€å®Ÿèµ°ã¯å¾Œï¼‰

---

## ðŸŽ¯ **ç›®çš„**

* Jetson ã¾ãŸã¯ PC ä¸Šã§å‹•ä½œã™ã‚‹ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’ä½œæˆ
* ã‚«ãƒ¡ãƒ©æ˜ åƒã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤ºï¼ˆ640Ã—480ï¼‰
* é­šçœ¼è£œæ­£ã‚’é©ç”¨
* SLIC superpixel segmentation ã®ç²’åº¦ã‚’ UI ã‚¹ãƒ©ã‚¤ãƒ€ã§å¤‰æ›´
* segmentation ã•ã‚ŒãŸé ˜åŸŸã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ **3åˆ†é¡ž**

  * `DRIVABLE` / `BLOCKED` / `UNKNOWN`
* èµ°è¡Œåˆ¤å®šç”¨ã® ROI æ°´å¹³ãƒ©ã‚¤ãƒ³ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã§å¤‰æ›´å¯èƒ½
* ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³çµæžœã«åŸºã¥ã„ã¦èµ°è¡Œå¯èƒ½çŽ‡ã‚„å·¦å³åˆ¤å®šã® debug å€¤ã‚’è¡¨ç¤º

---

## ðŸ§  **ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ**

```
Camera Stream (640x480)
    â†“
Fisheye Undistort  (OpenCV fisheye)
    â†“
SLIC Superpixel segmentation  (skimage or OpenCV)
    â†“
Overlay visualization + mask
    â†“
NiceGUI Web UI (PC browser)
    â†‘   â†‘    â†‘
 mouse-click   slider   ROI-line drag
```

---

## ðŸ‘¨â€ðŸ’» **å¿…è¦ãª Python ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**

| ãƒ©ã‚¤ãƒ–ãƒ©ãƒª               | ç”¨é€”                          |
| ------------------- | --------------------------- |
| opencv-python       | ã‚«ãƒ¡ãƒ©å–å¾— / undistort / overlay |
| numpy               | ç”»åƒå‡¦ç†                        |
| scikit-image        | SLIC segmentation           |
| nicegui             | WebUI                       |
| jetracer (optional) | èµ°è¡Œåˆ¶å¾¡çµ±åˆã®æº–å‚™                   |

---

## ðŸ“º **UI ä»•æ§˜ï¼ˆPCç”¨ï¼‰**

### ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Camera + Segmentation Overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [640x480] ç”»åƒã¨ superpixel, mask overlay                                                â”‚
â”‚ ROI horizontal line (ãƒ‰ãƒ©ãƒƒã‚°ã§ä¸Šä¸‹ç§»å‹•)                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Controls â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€ Debug â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Superpixel granularity slider (10-500) â”‚   â”‚ Drivable %              â”‚
â”‚ Class buttons: [DRIVABLE] [BLOCKED] [UNKNOWN] â”‚   â”‚ Left/Right ratio        â”‚
â”‚ Mode display                             â”‚   â”‚ FPS                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ–±ï¸ **ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã‚¤ãƒ™ãƒ³ãƒˆ**

| æ“ä½œ         | å‹•ä½œ                                  |
| ---------- | ----------------------------------- |
| ãƒžã‚¦ã‚¹ã‚¯ãƒªãƒƒã‚¯    | ã‚¯ãƒªãƒƒã‚¯ä½ç½®ã® superpixel ID ã‚’å–å¾—ã—ã€é¸æŠžã‚¯ãƒ©ã‚¹ã‚’ä»˜ä¸Ž |
| ç²’åº¦ã‚¹ãƒ©ã‚¤ãƒ€å¤‰æ›´   | SLIC segmentation ã‚’å†å®Ÿè¡Œã—ã¦å†æç”»         |
| ROIãƒ©ã‚¤ãƒ³ãƒ‰ãƒ©ãƒƒã‚° | y_cutline å€¤ã‚’å¤‰æ›´ï¼è¡¨ç¤ºæ›´æ–°                 |
| ã‚¯ãƒ©ã‚¹ãƒœã‚¿ãƒ³     | ã‚¯ãƒªãƒƒã‚¯æ™‚ã«æŒ‡å®šã‚¯ãƒ©ã‚¹ä»˜ä¸Žãƒ¢ãƒ¼ãƒ‰å¤‰æ›´                  |

---

## ðŸ§± **ãƒ‡ãƒ¼ã‚¿æ§‹é€ **

### segmentation çµæžœæ ¼ç´

```
segments: 2D array same size as image, value = superpixel ID
label_map: dict {superpixel_id: class_enum}
class_enum: {0: UNKNOWN, 1: DRIVABLE, 2: BLOCKED}
```

### ROIåˆ¤å®š

```
ROI = segments[y_cutline : 480, :]
drivable_ratio = % labeled DRIVABLE within ROI
left_ratio = ratio left half vs right half
```

---

## ðŸ“¡ **ä½Žé€Ÿèµ°è¡Œæ±ºå®šãƒ­ã‚¸ãƒƒã‚¯**

ï¼ˆç¾æ®µéšŽã§ã¯ debug ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤ºã®ã¿ï¼‰

```
if drivable_ratio > threshold:
    action = "FORWARD"
elif left_ratio > 0:
    action = "TURN_LEFT"
else:
    action = "TURN_RIGHT"
if drivable_ratio < stop_threshold:
    action = "STOP"
```

---

## ðŸªª **ã‚¯ãƒ©ã‚¹å®šç¾©æ¡ˆ**

```python
class SegmentLabel(Enum):
    UNKNOWN = 0
    DRIVABLE = 1
    BLOCKED = 2
```

---

## ðŸš— **èµ°è¡Œåˆ¶å¾¡ï¼ˆå¾Œã§çµ±åˆï¼‰**

JetRacer Adapter ã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«ç”¨æ„

```python
class VehicleController:
    def set_throttle(self, value: float):
        pass
    def set_steering(self, value: float):
        pass
```

